/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var t={58394:function(t,e,r){t.exports=r.p+"8625399fd7f513b4a65f.css"}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var a=e[n]={exports:{}};return t[n](a,a.exports,r),a.exports}r.m=t,r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t;r.g.importScripts&&(t=r.g.location+"");var e=r.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=n[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=t}(),r.b=document.baseURI||self.location.href,function(){var t="MPivot";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,c=[],u=!0,s=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return c}}(t,e)||o(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||o(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){if(t){if("string"==typeof t)return a(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function c(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t,e,r){return(e=f(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,f(n.key),n)}}function f(t){var r=function(t){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(r)?r:r+""}function l(){l=function(){return r};var t,r={},n=Object.prototype,o=n.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},c=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var o=e&&e.prototype instanceof w?e:w,i=Object.create(o.prototype),c=new _(n||[]);return a(i,"_invoke",{value:D(t,r,c)}),i}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}r.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",g={};function w(){}function b(){}function x(){}var O={};f(O,c,(function(){return this}));var k=Object.getPrototypeOf,j=k&&k(k(N([])));j&&j!==n&&o.call(j,c)&&(O=j);var P=x.prototype=w.prototype=Object.create(O);function S(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,r){function n(a,i,c,u){var s=h(t[a],t,i);if("throw"!==s.type){var f=s.arg,l=f.value;return l&&"object"==e(l)&&o.call(l,"__await")?r.resolve(l.__await).then((function(t){n("next",t,c,u)}),(function(t){n("throw",t,c,u)})):r.resolve(l).then((function(t){f.value=t,c(f)}),(function(t){return n("throw",t,c,u)}))}u(s.arg)}var i;a(this,"_invoke",{value:function(t,e){function o(){return new r((function(r,o){n(t,e,r,o)}))}return i=i?i.then(o,o):o()}})}function D(e,r,n){var o=d;return function(a,i){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=L(c,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var s=h(e,r,n);if("normal"===s.type){if(o=n.done?m:y,s.arg===g)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=m,n.method="throw",n.arg=s.arg)}}}function L(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,L(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var a=h(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,g;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function N(r){if(r||""===r){var n=r[c];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var a=-1,i=function e(){for(;++a<r.length;)if(o.call(r,a))return e.value=r[a],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(e(r)+" is not iterable")}return b.prototype=x,a(P,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:b,configurable:!0}),b.displayName=f(x,s,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,s,"GeneratorFunction")),t.prototype=Object.create(P),t},r.awrap=function(t){return{__await:t}},S(E.prototype),f(E.prototype,u,(function(){return this})),r.AsyncIterator=E,r.async=function(t,e,n,o,a){void 0===a&&(a=Promise);var i=new E(p(t,e,n,o),a);return r.isGeneratorFunction(e)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},S(P),f(P,s,"Generator"),f(P,c,(function(){return this})),f(P,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=N,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=o.call(i,"catchLoc"),s=o.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:N(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},r}function p(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function h(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){p(a,n,o,i,c,"next",t)}function c(t){p(a,n,o,i,c,"throw",t)}i(void 0)}))}}var d=function(t){for(var e="";t>0;){var r=(t-1)%26;e=String.fromCharCode(r+65)+e,t=Math.floor((t-r-1)/26)}return e},y=function(){var t=h(l().mark((function t(e,r,n){var o,a,i;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.workbook.worksheets,a=o.getItemOrNullObject(r),i=o.getItemOrNullObject(n),t.next=5,e.sync();case 5:return i.isNullObject||i.load(["position","tabColor"]),t.next=8,e.sync();case 8:return a.isNullObject||a.delete(),a=o.add(r),i.isNullObject||(a.position=i.position+1,a.tabColor=i.tabColor),a.activate(),t.next=14,e.sync();case 14:return t.abrupt("return",a);case 15:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),v=function(){var t=h(l().mark((function t(e){var r;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=e.workbook.getSelectedRange()).load(["worksheet/name","rowIndex","columnIndex","rowCount","columnCount"]),t.next=4,e.sync();case 4:return t.abrupt("return",{worksheetName:r.worksheet.name,rowIndex:r.rowIndex,columnIndex:r.columnIndex,rowCount:r.rowCount,columnCount:r.columnCount});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),m=function(){var t=h(l().mark((function t(e,r,n,o){var a,i;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.workbook.worksheets.getItem(r),(i=a.getRangeByIndexes(n,o,1,1)).load("values"),t.next=5,e.sync();case 5:return t.abrupt("return",i.values[0][0]);case 6:case"end":return t.stop()}}),t)})));return function(e,r,n,o){return t.apply(this,arguments)}}(),g=function(){var t=h(l().mark((function t(e,r){var n,o,a;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=g.eventResult)&&n.remove(),o=function(t){return Excel.run(function(){var e=h(l().mark((function e(n){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r(n,t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},a=function(){var t=h(l().mark((function t(){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Excel.run(n.context,function(){var t=h(l().mark((function t(e){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.remove(),t.next=3,e.sync();case 3:n=null;case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),n=g.eventResult=e.workbook.onSelectionChanged.add(o),t.next=7,e.sync();case 7:window.onbeforeunload=a,window.onunload=a;case 9:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),w=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._context=e,this._name=r.worksheet,this._sheet=e.workbook.worksheets.getItem(r.worksheet),this._fields=r.fields,this._progress=r.progress},e=[{key:"getDataIterator",value:(p=h(l().mark((function t(){var e,r,n,o,a,i=this,s=arguments;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=(s.length>0&&void 0!==s[0]?s[0]:{}).chunk||1e3,t.next=4,this.getDimensions();case 4:return r=t.sent,t.next=7,this.detectHeader();case 7:return n=t.sent,o=n.position+1,a=0,t.abrupt("return",h(l().mark((function t(){var s,f;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(o>=r.rowCount)){t.next=2;break}return t.abrupt("return",null);case 2:return t.next=4,i.getRows(o,Math.min(e,r.rowCount-o));case 4:return s=t.sent,a+=s.length,o+=s.length,f=s.map((function(t){return i._fields.reduce((function(e,r,o){var a=r.id,i=n.indexes[o],s=r.transform?r.transform(t[i]):t[i];return c(c({},e),{},u({},a,s))}),{})})),i._progress&&i._progress(a),t.abrupt("return",{data:f,total:a});case 10:case"end":return t.stop()}}),t)}))));case 11:case"end":return t.stop()}}),t,this)}))),function(){return p.apply(this,arguments)})},{key:"getData",value:(f=h(l().mark((function t(){var e,r,o;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=null,r=[],t.next=4,this.getDataIterator();case 4:o=t.sent;case 5:return t.next=7,o();case 7:if(!(e=t.sent)){t.next=11;break}r.push.apply(r,n(e.data)),t.next=5;break;case 11:return t.abrupt("return",r);case 12:case"end":return t.stop()}}),t,this)}))),function(){return f.apply(this,arguments)})},{key:"getDimensions",value:(i=h(l().mark((function t(){var e,r,n;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._dimensions){t.next=7;break}return(e=this._sheet.getUsedRange()).load(["rowCount","columnCount"]),t.next=5,this._context.sync();case 5:r=e.rowCount,n=e.columnCount,this._dimensions={rowCount:r,columnCount:n};case 7:return t.abrupt("return",this._dimensions);case 8:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"getRows",value:(a=h(l().mark((function t(e,r){var o,a,i;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getDimensions();case 2:return o=t.sent,a=o.columnCount,(i=this._sheet.getRangeByIndexes(e,0,r,a)).load("values"),t.next=8,this._context.sync();case 8:return t.abrupt("return",i.values.map((function(t){return n(t)})));case 9:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})},{key:"detectHeader",value:(o=h(l().mark((function t(){var e,n,o,a,i,c=this;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getDimensions();case 2:e=t.sent,n=e.rowCount,o=l().mark((function t(){var e,n,o,a;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.getRows(i,1);case 2:if(e=t.sent,n=r(e,1),o=n[0],(a=c._fields.map((function(t){return o.indexOf(t.title)}))).every((function(t){return t>=0}))){t.next=8;break}return t.abrupt("return",0);case 8:return t.abrupt("return",{v:{position:i,indexes:a}});case 9:case"end":return t.stop()}}),t)})),i=0;case 6:if(!(i<n)){t.next=16;break}return t.delegateYield(o(),"t0",8);case 8:if(0!==(a=t.t0)){t.next=11;break}return t.abrupt("continue",13);case 11:if(!a){t.next=13;break}return t.abrupt("return",a.v);case 13:i++,t.next=6;break;case 16:throw"Header not found on ".concat(this._name);case 17:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})}],e&&s(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,o,a,i,f,p}(),b=function(t){t instanceof Date||(t=new Date(t));var e=t.getDate(),r=t.getMonth(),n=t.getFullYear();return new Date(Date.UTC(n,r,e,0,0,0,0))},x={excel2js:function(t){return new Date(Date.UTC(0,0,t-1))},js2excel:function(t){var e=+b(t);return 25569+Math.floor(e/864e5)},js2utc:b,today:function(){return b(new Date)},inc:function(t,e){var r=e.months,n=new Date(t);return n.setMonth(t.getMonth()+r),n},format:function(t){var e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return"".concat(n,".").concat(r,".").concat(e)}};function O(t){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O(t)}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function j(){j=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),c=new _(n||[]);return o(i,"_invoke",{value:D(t,r,c)}),i}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function w(){}var b={};s(b,i,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==r&&n.call(k,i)&&(b=k);var P=w.prototype=m.prototype=Object.create(b);function S(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,a,i,c){var u=l(t[o],t,a);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==O(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(f).then((function(t){s.value=t,i(s)}),(function(t){return r("throw",t,i,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function D(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=L(c,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=l(e,r,n);if("normal"===s.type){if(o=n.done?y:h,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function L(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,L(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=l(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(O(e)+" is not iterable")}return g.prototype=w,o(P,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:g,configurable:!0}),g.displayName=s(w,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(P),t},e.awrap=function(t){return{__await:t}},S(E.prototype),s(E.prototype,c,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new E(f(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},S(P),s(P,u,"Generator"),s(P,i,(function(){return this})),s(P,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=N,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:N(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function P(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function S(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){P(a,n,o,i,c,"next",t)}function c(t){P(a,n,o,i,c,"throw",t)}i(void 0)}))}}var E=function(){var t=S(j().mark((function t(e,r){var n,o,a,i,c;return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new w(e,{worksheet:"КАТАЛОГ",fields:[{id:"propertyId",title:"ID"},{id:"propertyName",title:"Назва предмета"},{id:"measureUnit",title:"Одиниці виміру"},{id:"normCount",title:"Кількість"},{id:"normPeriod",title:"Строк користування"},{id:"price",title:"Ціна"},{id:"actualPrice",title:"Актуальна ціна"},{id:"contractPrice",title:"Ціна для контрактників"},{id:"isInventory",title:"Інвентарне майно",transform:function(t){return"І"==t}},{id:"isNoReturn",title:"Без повернення",transform:function(t){return"БП"==t}},{id:"sexFilter",title:"Стать",transform:function(t){return{male:!t||"Ч"==t,female:!t||"Ж"==t}}}],progress:function(t){return r.updateProgress("Вичитую каталог ".concat(t))}}),t.next=3,n.getData();case 3:return o=t.sent,a=function(t){return function(e){return e.propertyId==t}},i=function(t){return function(e){return e.propertyName==t}},c=function(t){return t.propertyName},t.abrupt("return",{getById:function(t){return o.find(a(t))},getByName:function(t){return o.find(i(t))},getNames:function(){return o.map(c)}});case 8:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),D=function(){var t=S(j().mark((function t(e,r){var n,o,a;return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new w(e,{worksheet:"ШТАТКА",fields:[{id:"personId",title:"№ фін"},{id:"personName",title:"ПІБ"},{id:"battalion",title:"Б"},{id:"company",title:"Р"},{id:"platoon",title:"Взв"},{id:"squad",title:"Від"},{id:"contract",title:"Контрактник",transform:function(t){return"К"==t}},{id:"contractStartDate",title:"Дані про контракт",transform:function(t){return t?x.excel2js(t):null}},{id:"sex",title:"Стать",transform:function(t){return"Ж"==t?"female":"male"}}],progress:function(t){return r.updateProgress("Вичитую дані про штат ".concat(t))}}),t.next=3,n.getData();case 3:return o=t.sent,a=function(t){return function(e){return e.personId==t}},t.abrupt("return",{getById:function(t){return o.find(a(t))}});case 6:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),L=function(){var t=S(j().mark((function t(e,r,n){var o,a;return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=new w(e,{worksheet:"Реєстр видачі",fields:[{id:"documentDate",title:"Дата документа",transform:x.excel2js},{id:"personId",title:"№ фін"},{id:"personName",title:"ПІБ"}].concat((i=r.map((function(t){return{id:t,title:t}})),function(t){if(Array.isArray(t))return k(t)}(i)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(i)||function(t,e){if(t){if("string"==typeof t)return k(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?k(t,e):void 0}}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),progress:function(t){return n.updateProgress("Вичитую реєстр видачі ".concat(t))}}),t.next=3,o.getData();case 3:return a=t.sent,t.abrupt("return",a);case 5:case"end":return t.stop()}var i}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),C={getCatalog:E,getStaff:D,getRegistry:L},I=!1,_=function(t){I=t},N=function(t){I&&console.log(t)};function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}var A=["props","people"],F=["props","people"],R=["props","people"],G=["props","people"],B=["props","people"];function M(){M=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:S(t,r,c)}),i}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function w(){}var b={};s(b,i,(function(){return this}));var x=Object.getPrototypeOf,O=x&&x(x(I([])));O&&O!==r&&n.call(O,i)&&(b=O);var k=w.prototype=m.prototype=Object.create(b);function j(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(o,a,i,c){var u=l(t[o],t,a);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==T(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(f).then((function(t){s.value=t,i(s)}),(function(t){return r("throw",t,i,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function S(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=E(c,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=l(e,r,n);if("normal"===s.type){if(o=n.done?y:h,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function E(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,E(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=l(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function D(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(D,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(T(e)+" is not iterable")}return g.prototype=w,o(k,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:g,configurable:!0}),g.displayName=s(w,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(P.prototype),s(P.prototype,c,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new P(f(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},j(k),s(k,u,"Generator"),s(k,i,(function(){return this})),s(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function U(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function H(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){U(a,n,o,i,c,"next",t)}function c(t){U(a,n,o,i,c,"throw",t)}i(void 0)}))}}function Y(t){return function(t){if(Array.isArray(t))return J(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||X(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function V(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?z(Object(r),!0).forEach((function(e){q(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function q(t,e,r){return(e=function(t){var e=function(t){if("object"!=T(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=T(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==T(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function K(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}function W(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=X(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}function X(t,e){if(t){if("string"==typeof t)return J(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?J(t,e):void 0}}function J(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var Q=["ПІБ","№ фін","K","Б","Р"],Z=["Друга категорія","Третя категорія"],tt="ВИДАЧА",et=function(t){return!!t.meta.sexFilter[t.sex]},rt=function(t,e){return t.meta.isNoReturn&&e<0?0:e},nt=function(t){return t.records.reduce((function(e,r){return e+rt(t,r.count)}),0)},ot=function(t){if(t.contractStartDate){var e,r=null,n=t.contractStartDate,o=x.inc(t.contractStartDate,{months:t.meta.normPeriod}),a=0,i=W(function(t){var e,r=[],n=0,o=W(t.records);try{for(o.s();!(e=o.n()).done;){var a=e.value;if(rt(t,a.count)==a.count&&!(a.count+n<0))if(n+=a.count,a.count>0)r.push(a);else if(a.count<0)for(var i=-a.count;i>0&&r.length;){var c=r[0];c.count>i?(c.count-=i,i=0):(i-=c.count,r.shift())}}}catch(t){o.e(t)}finally{o.f()}return r}(t));try{for(i.s();!(e=i.n()).done;){var c=e.value,u=c.date,s=c.count/t.meta.normCount*t.meta.normPeriod,f=x.inc(u,{months:s});f<n||(!r&&u<n?r=f:(!r&&u<o&&(r=u),a+=c.count))}}catch(t){i.e(t)}finally{i.f()}return{startDate:r||n,totalCount:a}}return{startDate:t.records.length?t.records[0].date:t.admissionDate,totalCount:nt(t)}},at=function(t){for(var e=[],r={months:t.meta.normPeriod},n=x.inc(t.referenceDate,r),o=t.admissionDate;o<n;o=x.inc(o,r))e.push({start:o,end:x.inc(o,r),transferred:0,issued:0,overflow:0,unused:0,max:t.meta.normCount});var a,i=W(t.records);try{var c=function(){var r=a.value,n=e.find((function(t){return r.date>=t.start&&r.date<t.end}));n.issued+=rt(t,r.count)};for(i.s();!(a=i.n()).done;)c()}catch(t){i.e(t)}finally{i.f()}for(var u=0,s=0,f=e;s<f.length;s++){var l=f[s];l.transferred=u,l.transferred+l.issued>l.max?l.overflow=l.transferred+l.issued-l.max:l.unused=l.max-(l.transferred+l.issued),u=l.overflow}return e},it=function(t){var e=t.referenceDate,r=function(r){return t.roundToToday&&r instanceof Date&&r<e&&(r=e),t.onlyActive&&(r=r==e?e:""),t.excelFormat?r instanceof Date?x.js2excel(r):r?"".concat(r," од."):"":r instanceof Date?x.format(r):r?"".concat(r," од."):""},n=t.records[t.records.length-1];if(!et(t))return r("");if(!t.records.length)return r(e);if(t.meta.isInventory){var o=nt(t);return r(o<=0?e:o)}if(t.contract){var a=ot(t),i=a.startDate,c=a.totalCount/t.meta.normCount*t.meta.normPeriod;return r(x.inc(i,{months:c}))}if(t.matchMobPeriod){var u=at(t).find((function(t){return e>=t.start&&e<t.end}));if(u.unused>0)return r(u.start);var s=(u.issued+u.transferred)/t.meta.normCount*t.meta.normPeriod;return r(x.inc(u.start,{months:s}))}if(n.count<0)return r(e);var f=n.date,l=n.count/t.meta.normCount*t.meta.normPeriod;return r(x.inc(f,{months:l}))},ct=function(t,e,r){var n=r.props,o=r.people,a=K(r,A),i=n[e],c=o[t],u=c.items[e]||[];c.contract&&(t+=" (КОНТРАКТ)");var s={name:e,meta:i,records:u,admissionDate:c.admissionDate,contract:c.contract,contractStartDate:c.contractStartDate,sex:c.sex,matchMobPeriod:a.matchMobPeriod,referenceDate:a.referenceDate,debug:!0},f=it(V({},s)),l=it(V(V({},s),{},{roundToToday:!0}));f!=l&&(f="".concat(f," > ").concat(l));var p=[];if(p.push(t),p.push("Дата прийому: ".concat(x.format(c.admissionDate))),c.contractStartDate&&p.push("Дата контракту: ".concat(x.format(c.contractStartDate))),p.push(""),p.push(e),p.push(""),!et(s))return p.push("Не актуально для цієї статі"),p.join("\n");if(p.push("Історія видачі:"),u.length?(p.push.apply(p,Y(u.map((function(t){var e,r=(e=t.count)>=0?"+".concat(e):"".concat(e),n=x.format(t.date),o=rt(s,t.count)!=t.count?"(ігнор.)":"";return"".concat(r," од. @ ").concat(n," ").concat(o)})))),p.push("Всього: ".concat(nt(s)," од."))):p.push("Відсутня"),!i.isInventory){if(c.contract){p.push(""),p.push("Графік для контрактників:");var h,d=function(t){for(var e=[],r=ot(t).startDate,n={months:t.meta.normPeriod},o=x.inc(new Date,{months:48});r<o;){var a=x.inc(r,n),i=(e.length+1)*t.meta.normCount;e.push({start:r,end:a,count:i}),r=a}return e}(s),y=W(d);try{for(y.s();!(h=y.n()).done;){var v=h.value;p.push("".concat(x.format(v.start)," - ").concat(v.count))}}catch(t){y.e(t)}finally{y.f()}}else{p.push(""),p.push("Графік для мобілізованих:");var m,g=W(at(s));try{for(g.s();!(m=g.n()).done;){var w=m.value,b="".concat(w.transferred+w.issued,"/").concat(w.max),O=w.overflow?"-> ".concat(w.overflow):"";p.push("".concat(x.format(w.start)," - ").concat(b," ").concat(O))}}catch(t){g.e(t)}finally{g.f()}}p.push(""),p.push("Розрахунок наступної видачі:"),p.push("".concat(f))}return p.push("","---",""),p.push("Норма: ".concat(i.normCount," од. на ").concat(i.normPeriod," міс.")),p.join("\n")},ut=function(t,e,r){var n=Object.keys(e),o=n.length,a=Object.keys(r),i=a.length,c=Z.length,u=Q.length,s={summaryHeader:{rowOffset:0,colOffset:0,rowCount:c,colCount:1,genData:function(){return Z.map((function(t){return[t]}))}},summaryFormulas:{rowOffset:0,colOffset:u,rowCount:c,colCount:o,genData:function(t){return Z.map((function(e,r){return n.map((function(e,n){var o=Q.length,a=s.tableData,i=d(o+n+1),c=a.rowOffset+1,u=a.rowOffset+a.rowCount;if(t.onlyActive){if(!r){var f=d(a.colOffset+1),l="".concat(f).concat(c,":").concat(f).concat(u),p=s.summaryHeader.rowOffset+1+1;return"=SUBTOTAL(103, ".concat(l,")-").concat(i).concat(p)}var h="".concat(i).concat(c,":").concat(i).concat(u);return"=SUBTOTAL(103, ".concat(h,")")}var y=x.js2excel(x.today()),v="".concat(i).concat(c,":").concat(i).concat(u),m=r?"=":">",g="".concat(v).concat(m).concat(y),w="ROW(".concat(v,")-MIN(ROW(").concat(v,"))"),b="OFFSET(INDEX(".concat(v,", 1), ").concat(w,", 0)"),O="SUBTOTAL(103, ".concat(b,")");return"=SUMPRODUCT((".concat(g,")*").concat(O,")")}))}))}},tableHeader:{rowOffset:c,colOffset:0,rowCount:1,colCount:u+o,genData:function(){return[Q.concat(n)]}},tablePropertiesHeader:{rowOffset:c,colOffset:u,rowCount:1,colCount:o},tableData:{rowOffset:c+1,colOffset:0,rowCount:i,colCount:u+o,genData:function(t){return a.map((function(o){var a=r[o],i=a.finId,c=a.contract,u=a.contractStartDate,s=a.battalion,f=a.company,l=a.items,p=a.admissionDate,h=a.sex;return[o,i,c?"К":"",s,f].concat(n.map((function(r){return it({personName:o,name:r,meta:e[r],records:l[r]||[],admissionDate:p,contract:c,contractStartDate:u,sex:h,roundToToday:!0,onlyActive:t.onlyActive,matchMobPeriod:t.matchMobPeriod,referenceDate:t.referenceDate,excelFormat:!0})})))}))}},tableCalcData:{rowOffset:c+1,colOffset:u,rowCount:i,colCount:o},tableCenterData:{rowOffset:c,colOffset:1,rowCount:1+i,colCount:u+o-1}},f=s[t],l=[f.rowOffset,f.colOffset,f.rowCount,f.colCount];return V(V({},f),{},{range:l})},st=function(){var t=H(M().mark((function t(e,r){var n,o,a,i,c,u,s,f,l,p,h,d,y,v,m,g,w,b,O,k,j,P,S,E,D,L,I,_;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C.getCatalog(e,r);case 2:return n=t.sent,t.next=5,C.getStaff(e,r);case 5:return o=t.sent,t.next=8,C.getRegistry(e,n.getNames(),r);case 8:a=t.sent,i={},c=W(n.getNames()),t.prev=11,c.s();case 13:if((u=c.n()).done){t.next=21;break}if(s=u.value,(f=n.getByName(s)).normCount&&f.normPeriod){t.next=18;break}return t.abrupt("continue",19);case 18:i[s]=f;case 19:t.next=13;break;case 21:t.next=26;break;case 23:t.prev=23,t.t0=t.catch(11),c.e(t.t0);case 26:return t.prev=26,c.f(),t.finish(26);case 29:l={},p=W(a),t.prev=31,p.s();case 33:if((h=p.n()).done){t.next=65;break}if(d=h.value,y=l[d.personName],N=(v=o.getById(d.personId)).battalion,!(N="".concat(N))||!N.includes("переведено")&&!N.includes("звільнено")){t.next=39;break}return t.abrupt("continue",63);case 39:y?d.documentDate<y.admissionDate&&(y.admissionDate=d.documentDate):y=l[d.personName]={finId:d.personId,admissionDate:d.documentDate,contract:v.contract,contractStartDate:v.contractStartDate,sex:v.sex,battalion:v.battalion,company:v.company,records:0,items:{}},y.records++,m=W(n.getNames()),t.prev=42,m.s();case 44:if((g=m.n()).done){t.next=55;break}if(w=g.value,(b=+"".concat(d[w]).trim())&&!isNaN(b)){t.next=49;break}return t.abrupt("continue",53);case 49:O=y.items[w]=y.items[w]||[],k=O.find((function(t){return t.date==x})),j=O[O.length-1],k&&b*j.count>0?k.count+=b:O.push({date:d.documentDate,count:b});case 53:t.next=44;break;case 55:t.next=60;break;case 57:t.prev=57,t.t1=t.catch(42),m.e(t.t1);case 60:return t.prev=60,m.f(),t.finish(60);case 63:t.next=33;break;case 65:t.next=70;break;case 67:t.prev=67,t.t2=t.catch(31),p.e(t.t2);case 70:return t.prev=70,p.f(),t.finish(70);case 73:for(P=0,S=Object.keys(l);P<S.length;P++)for(E=S[P],D=l[E].items,L=0,I=Object.keys(D);L<I.length;L++)_=I[L],D[_].sort((function(t,e){return t.date-e.date}));return console.log("Каталог: ",i),console.log("Людиська: ",l),t.abrupt("return",{props:i,people:l});case 77:case"end":return t.stop()}var N}),t,null,[[11,23,26,29],[31,67,70,73],[42,57,60,63]])})));return function(e,r){return t.apply(this,arguments)}}(),ft=function(){var t=H(M().mark((function t(e,r){var n,o,a,i,c,u,s,f,l,p,h;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.props,o=r.people,(a=K(r,F)).updateProgress("Створюю вихідні дані..."),t.next=4,y(e,tt,"ЗВЕДЕНА");case 4:return i=t.sent,a.updateProgress("Заповнюю заголовок..."),c=ut("tableHeader",n,o),(u=i.getRangeByIndexes.apply(i,Y(c.range))).values=c.genData(),u.format.horizontalAlignment="Center",t.next=12,e.sync();case 12:a.updateProgress("Заповнюю вихідні дані..."),s=ut("tableData",n,o),f=s.genData(a),l=0;case 16:if(!(l<f.length)){t.next=27;break}if(!l||l%1e3!=0){t.next=22;break}return N("pivot process ".concat(l," rows")),a.updateProgress("Заповнюю вихідні дані... (".concat(l,")")),t.next=22,e.sync();case 22:i.getRangeByIndexes(s.rowOffset+l,s.colOffset,1,s.colCount).values=[f[l]];case 24:l++,t.next=16;break;case 27:return t.next=29,e.sync();case 29:return a.updateProgress("Додаю заголовки для категорій..."),p=ut("summaryHeader",n,o),i.getRangeByIndexes.apply(i,Y(p.range)).values=p.genData(),t.next=35,e.sync();case 35:return a.updateProgress("Додаю формули для категорій..."),h=ut("summaryFormulas",n,o),i.getRangeByIndexes.apply(i,Y(h.range)).values=h.genData(a),t.next=41,e.sync();case 41:return t.abrupt("return",i);case 42:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),lt=function(){var t=H(M().mark((function t(e,r,n){var o,a,i,c,u,s,f,l,p,h,d,y,v,m;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=n.props,a=n.people,(i=K(n,R)).updateProgress("Встановлюю підсвітку для дат..."),c=ut("tableCalcData",o,a),u=r.getRangeByIndexes.apply(r,Y(c.range)),s=x.format(i.referenceDate),(f=u.conditionalFormats.add(Excel.ConditionalFormatType.cellValue)).cellValue.format.fill.color="lightgreen",f.cellValue.rule={formula1:'=DATEVALUE("'.concat(s,'")'),operator:"EqualTo"},u.numberFormat="dd.mm.yyyy",t.next=11,e.sync();case 11:return i.updateProgress("Вирівнюю дані по центру..."),l=ut("tableCenterData",o,a),r.getRangeByIndexes.apply(r,Y(l.range)).format.horizontalAlignment="Center",t.next=17,e.sync();case 17:return i.updateProgress("Стилізую заголовок таблиці..."),p=ut("tablePropertiesHeader",o,a),(h=r.getRangeByIndexes.apply(r,Y(p.range))).format.textOrientation=90,h.format.wrapText=!0,h.format.rowHeight=150,h.load("values"),t.next=26,e.sync();case 26:for(d=h.values[0],y=0;y<d.length;y++)v=d[y],h.getCell(0,y).format.fill.color=(g=o[v]).isInventory?"#FFFF00":g.isNoReturn?"#FFC000":"#FFFFFF";return t.next=30,e.sync();case 30:return i.updateProgress("Встановлюю оптимальний розмір комірок..."),(m=r.getUsedRange()).format.autofitColumns(),m.format.autofitRows(),t.next=36,e.sync();case 36:return t.abrupt("return",r);case 37:case"end":return t.stop()}var g}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),pt=function(){var e=H(M().mark((function e(r,n,o){var a,i,c,u,s,f,l,p,h,d,y;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.props,i=o.people,(c=K(o,G)).updateProgress("Конвертую у таблицю..."),u=ut("tableHeader",a,i),s=ut("tableData",a,i),f=n.getRangeByIndexes(u.rowOffset,u.colOffset,u.rowCount+s.rowCount,u.colCount),(l=n.tables.add(f,!0)).showBandedRows=!1,l.style="TableStyleLight21",n.freezePanes.freezeColumns(3),n.freezePanes.freezeRows(3),e.next=12,r.sync();case 12:return c.updateProgress("Приховую зайві колонки..."),(p=n.getRange("D:E")).group(Excel.GroupOption.byColumns),p.columnHidden=!0,e.next=18,r.sync();case 18:return c.updateProgress("Додаю нагадування про оновлення..."),(h=n.getRangeByIndexes(u.rowOffset,u.colOffset,1,1)).load(["width","height","left","top"]),e.next=23,r.sync();case 23:return(d=n.shapes.addTextBox("!!! ОНОВИТИ ПЕРЕД ВИКОРИСТАННЯМ !!!")).name=t+"_refresh_warning",d.width=Math.min(150,h.width),d.height=Math.min(50,h.height),d.left=h.left+h.width/2-d.width/2,d.top=h.top+h.height/2-d.height/2,d.textFrame.horizontalAlignment="Center",d.textFrame.verticalAlignment="Middle",d.fill.setSolidColor("yellow"),e.next=34,r.sync();case 34:return c.updateProgress("Зміщую фокус на першу комірку..."),y=ut("tableCalcData",a,i),n.getRangeByIndexes(y.rowOffset,y.colOffset,1,1).select(),e.next=40,r.sync();case 40:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),ht=function(t,e){var r=e.props,n=e.people,o=K(e,B),a=function(t){return t.worksheetName==tt&&1==t.columnCount&&1==t.rowCount&&!!function(t,e){return t.rowIndex>=e.rowOffset&&t.rowIndex<e.rowOffset+e.rowCount&&t.columnIndex>=e.colOffset&&t.columnIndex<e.colOffset+e.colCount}(t,ut("tableCalcData",r,n))},i=function(){var t=H(M().mark((function t(e){var i,c,u,s,f,l;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v(e);case 2:if(i=t.sent,a(i)){t.next=5;break}return t.abrupt("return",o.updateProgress(""));case 5:return c=ut("tableHeader",r,n),u=ut("tableData",r,n),s=function(t,r){return m(e,i.worksheetName,t,r)},t.next=10,s(c.rowOffset,i.columnIndex);case 10:return f=t.sent,t.next=13,s(i.rowIndex,u.colOffset);case 13:l=t.sent,o.updateProgress(ct(l,f,V({props:r,people:n},o)));case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();g(t,function(){var t=H(M().mark((function t(e){return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{i(e)}catch(t){o.updateProgress("Помилка: "+t),console.error(t)}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},dt=function(){var t=H(M().mark((function t(e){return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Excel.run(function(){var t=H(M().mark((function t(r){var n,o,a,i;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,st(r,e);case 2:return n=t.sent,o=n.props,a=n.people,t.next=7,ft(r,V({props:o,people:a},e));case 7:return i=t.sent,t.next=10,lt(r,i,V({props:o,people:a},e));case 10:return t.next=12,pt(r,i,V({props:o,people:a},e));case 12:ht(r,V({props:o,people:a},e)),e.updateProgress("Готово!");case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),yt={run:dt};$("#header").on("dblclick",(function(e){e.ctrlKey&&(_(!0),N("".concat(t," by ").concat("Volodymyr Tytar",": ").concat("https://gist.github.com/vtytar/12cc96ad53a3877cb17095b84684b23c")))})),$("#ref-date-control").on("click",(function(t){var e=$(t.target).prop("checked"),r=$("#ref-date").val(),n=x.today().toISOString().split("T")[0];$("#ref-date").css("display",e?"inline":"none"),e&&!r&&$("#ref-date").val(n)})),$("#ref-date").css("display","none"),$("#ref-date").on("change",(function(t){var e=!$(t.target).val();$("#ref-date-control").prop("checked",!e),$("#ref-date").css("display",e?"none":"inline")})),$("#refresh").on("click",(function(){return yt.run({onlyActive:$("#only-active").prop("checked"),matchMobPeriod:$("#match-mob-period").prop("checked"),referenceDate:$("#ref-date-control").prop("checked")?x.js2utc($("#ref-date").val()):x.today(),updateProgress:function(t){return $("#update").text(t)}})})),Office.onReady((function(t){t.host!==Office.HostType.Excel?($("#ref-date").prop("disabled",!0),$("#ref-date-control").prop("disabled",!0),$("#only-active").prop("disabled",!0),$("#match-mob-period").prop("disabled",!0),$("#refresh").prop("disabled",!0)):_(!0)}))}(),new URL(r(58394),r.b)}();
//# sourceMappingURL=taskpane.js.map