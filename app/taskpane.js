/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var t={58394:function(t,e,r){t.exports=r.p+"8625399fd7f513b4a65f.css"}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var a=e[n]={exports:{}};return t[n](a,a.exports,r),a.exports}r.m=t,r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t;r.g.importScripts&&(t=r.g.location+"");var e=r.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=n[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=t}(),r.b=document.baseURI||self.location.href,function(){var t="MPivot";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,c=[],u=!0,s=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return c}}(t,e)||o(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||o(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){if(t){if("string"==typeof t)return a(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,c(n.key),n)}}function c(t){var r=function(t){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(r)?r:r+""}function u(){u=function(){return r};var t,r={},n=Object.prototype,o=n.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},c=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",f=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var o=e&&e.prototype instanceof w?e:w,i=Object.create(o.prototype),c=new _(n||[]);return a(i,"_invoke",{value:P(t,r,c)}),i}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}r.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",g={};function w(){}function b(){}function x(){}var O={};l(O,c,(function(){return this}));var k=Object.getPrototypeOf,S=k&&k(k(N([])));S&&S!==n&&o.call(S,c)&&(O=S);var E=x.prototype=w.prototype=Object.create(O);function j(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function D(t,r){function n(a,i,c,u){var s=h(t[a],t,i);if("throw"!==s.type){var f=s.arg,l=f.value;return l&&"object"==e(l)&&o.call(l,"__await")?r.resolve(l.__await).then((function(t){n("next",t,c,u)}),(function(t){n("throw",t,c,u)})):r.resolve(l).then((function(t){f.value=t,c(f)}),(function(t){return n("throw",t,c,u)}))}u(s.arg)}var i;a(this,"_invoke",{value:function(t,e){function o(){return new r((function(r,o){n(t,e,r,o)}))}return i=i?i.then(o,o):o()}})}function P(e,r,n){var o=d;return function(a,i){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=L(c,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var s=h(e,r,n);if("normal"===s.type){if(o=n.done?m:y,s.arg===g)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=m,n.method="throw",n.arg=s.arg)}}}function L(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,L(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var a=h(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,g;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function N(r){if(r||""===r){var n=r[c];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var a=-1,i=function e(){for(;++a<r.length;)if(o.call(r,a))return e.value=r[a],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(e(r)+" is not iterable")}return b.prototype=x,a(E,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:b,configurable:!0}),b.displayName=l(x,f,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,l(t,f,"GeneratorFunction")),t.prototype=Object.create(E),t},r.awrap=function(t){return{__await:t}},j(D.prototype),l(D.prototype,s,(function(){return this})),r.AsyncIterator=D,r.async=function(t,e,n,o,a){void 0===a&&(a=Promise);var i=new D(p(t,e,n,o),a);return r.isGeneratorFunction(e)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},j(E),l(E,f,"Generator"),l(E,c,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=N,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=o.call(i,"catchLoc"),s=o.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:N(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},r}function s(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function f(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){s(a,n,o,i,c,"next",t)}function c(t){s(a,n,o,i,c,"throw",t)}i(void 0)}))}}var l=function(t){for(var e="";t>0;){var r=(t-1)%26;e=String.fromCharCode(r+65)+e,t=Math.floor((t-r-1)/26)}return e},p=function(){var t=f(u().mark((function t(e,r,n){var o,a,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.workbook.worksheets,a=o.getItemOrNullObject(r),i=o.getItemOrNullObject(n),t.next=5,e.sync();case 5:return i.isNullObject||i.load(["position","tabColor"]),t.next=8,e.sync();case 8:return a.isNullObject||a.delete(),a=o.add(r),i.isNullObject||(a.position=i.position+1,a.tabColor=i.tabColor),a.activate(),t.next=14,e.sync();case 14:return t.abrupt("return",a);case 15:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),h=function(){var t=f(u().mark((function t(e){var r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=e.workbook.getSelectedRange()).load(["worksheet/name","rowIndex","columnIndex","rowCount","columnCount"]),t.next=4,e.sync();case 4:return t.abrupt("return",{worksheetName:r.worksheet.name,rowIndex:r.rowIndex,columnIndex:r.columnIndex,rowCount:r.rowCount,columnCount:r.columnCount});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),d=function(){var t=f(u().mark((function t(e,r,n,o){var a,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.workbook.worksheets.getItem(r),(i=a.getRangeByIndexes(n,o,1,1)).load("values"),t.next=5,e.sync();case 5:return t.abrupt("return",i.values[0][0]);case 6:case"end":return t.stop()}}),t)})));return function(e,r,n,o){return t.apply(this,arguments)}}(),y=function(){var t=f(u().mark((function t(e,r){var n,o,a;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=y.eventResult)&&n.remove(),o=function(t){return Excel.run(function(){var e=f(u().mark((function e(n){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r(n,t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},a=function(){var t=f(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Excel.run(n.context,function(){var t=f(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.remove(),t.next=3,e.sync();case 3:n=null;case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),n=y.eventResult=e.workbook.onSelectionChanged.add(o),t.next=7,e.sync();case 7:window.onbeforeunload=a,window.onunload=a;case 9:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),v=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._context=e,this._name=r.worksheet,this._sheet=e.workbook.worksheets.getItem(r.worksheet),this._fields=r.fields,this._progress=r.progress},e=[{key:"getDataIterator",value:(l=f(u().mark((function t(){var e,r,n,o,a,i=this,c=arguments;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=(c.length>0&&void 0!==c[0]?c[0]:{}).chunk||1e3,t.next=4,this.getDimensions();case 4:return r=t.sent,t.next=7,this.detectHeader();case 7:return n=t.sent,o=n.position+1,a=0,t.abrupt("return",f(u().mark((function t(){var c,s;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(o>=r.rowCount)){t.next=2;break}return t.abrupt("return",null);case 2:return t.next=4,i.getRows(o,Math.min(e,r.rowCount-o));case 4:return c=t.sent,a+=c.length,o+=c.length,s=c.map((function(t){return i._fields.reduce((function(e,r,o){var a=r.id,i=n.indexes[o],c=r.transform?r.transform(t[i]):t[i];return e[a]=c,e}),{})})),i._progress&&i._progress(a),t.abrupt("return",{data:s,total:a});case 10:case"end":return t.stop()}}),t)}))));case 11:case"end":return t.stop()}}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"getData",value:(s=f(u().mark((function t(){var e,r,n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=null,r=[],t.next=4,this.getDataIterator();case 4:n=t.sent;case 5:return t.next=7,n();case 7:if(!(e=t.sent)){t.next=11;break}r=r.concat(e.data),t.next=5;break;case 11:return t.abrupt("return",r);case 12:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"getDimensions",value:(c=f(u().mark((function t(){var e,r,n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._dimensions){t.next=7;break}return(e=this._sheet.getUsedRange()).load(["rowCount","columnCount"]),t.next=5,this._context.sync();case 5:r=e.rowCount,n=e.columnCount,this._dimensions={rowCount:r,columnCount:n};case 7:return t.abrupt("return",this._dimensions);case 8:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"getRows",value:(a=f(u().mark((function t(e,r){var o,a,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getDimensions();case 2:return o=t.sent,a=o.columnCount,(i=this._sheet.getRangeByIndexes(e,0,r,a)).load("values"),t.next=8,this._context.sync();case 8:return t.abrupt("return",i.values.map((function(t){return n(t)})));case 9:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})},{key:"detectHeader",value:(o=f(u().mark((function t(){var e,n,o,a,i,c=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getDimensions();case 2:e=t.sent,n=e.rowCount,o=u().mark((function t(){var e,n,o,a;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.getRows(i,1);case 2:if(e=t.sent,n=r(e,1),o=n[0],(a=c._fields.map((function(t){return o.indexOf(t.title)}))).every((function(t){return t>=0}))){t.next=8;break}return t.abrupt("return",0);case 8:return t.abrupt("return",{v:{position:i,indexes:a}});case 9:case"end":return t.stop()}}),t)})),i=0;case 6:if(!(i<n)){t.next=16;break}return t.delegateYield(o(),"t0",8);case 8:if(0!==(a=t.t0)){t.next=11;break}return t.abrupt("continue",13);case 11:if(!a){t.next=13;break}return t.abrupt("return",a.v);case 13:i++,t.next=6;break;case 16:throw"Header not found on ".concat(this._name);case 17:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})}],e&&i(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,o,a,c,s,l}(),m=function(t){t instanceof Date||(t=new Date(t));var e=t.getDate(),r=t.getMonth(),n=t.getFullYear();return new Date(Date.UTC(n,r,e,0,0,0,0))},g={excel2js:function(t){return new Date(Date.UTC(0,0,t-1))},js2excel:function(t){var e=+m(t);return 25569+Math.floor(e/864e5)},js2utc:m,today:function(){return m(new Date)},inc:function(t,e){var r=e.months,n=new Date(t);return n.setMonth(t.getMonth()+r),n},format:function(t){var e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return"".concat(n,".").concat(r,".").concat(e)}};function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function x(){x=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),c=new _(n||[]);return o(i,"_invoke",{value:P(t,r,c)}),i}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var O={};s(O,i,(function(){return this}));var k=Object.getPrototypeOf,S=k&&k(k(N([])));S&&S!==r&&n.call(S,i)&&(O=S);var E=b.prototype=m.prototype=Object.create(O);function j(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function D(t,e){function r(o,a,i,c){var u=l(t[o],t,a);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==w(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(f).then((function(t){s.value=t,i(s)}),(function(t){return r("throw",t,i,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function P(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=L(c,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=l(e,r,n);if("normal"===s.type){if(o=n.done?y:h,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function L(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,L(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=l(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(w(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},j(D.prototype),s(D.prototype,c,(function(){return this})),e.AsyncIterator=D,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new D(f(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},j(E),s(E,u,"Generator"),s(E,i,(function(){return this})),s(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=N,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:N(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function O(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function k(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){O(a,n,o,i,c,"next",t)}function c(t){O(a,n,o,i,c,"throw",t)}i(void 0)}))}}var S=function(){var t=k(x().mark((function t(e,r){var n,o,a,i,c;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new v(e,{worksheet:"КАТАЛОГ",fields:[{id:"propertyId",title:"ID"},{id:"propertyName",title:"Назва предмета"},{id:"normCount",title:"Кількість"},{id:"normPeriod",title:"Строк користування"},{id:"isInventory",title:"Інвентарне майно",transform:function(t){return"І"==t}},{id:"isNoReturn",title:"Без повернення",transform:function(t){return"БП"==t}},{id:"sexFilter",title:"Стать",transform:function(t){return{male:!t||"Ч"==t,female:!t||"Ж"==t}}}],progress:function(t){return r.updateProgress("Вичитую каталог... (".concat(t,")"))}}),t.next=3,n.getData();case 3:return o=t.sent,a=function(t){return function(e){return e.propertyId==t}},i=function(t){return function(e){return e.propertyName==t}},c=function(t){return t.propertyName},t.abrupt("return",{getById:function(t){return o.find(a(t))},getByName:function(t){return o.find(i(t))},getNames:function(){return o.map(c)}});case 8:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),E=function(){var t=k(x().mark((function t(e,r){var n,o,a;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new v(e,{worksheet:"ШТАТКА",fields:[{id:"personId",title:"№ фін"},{id:"personName",title:"ПІБ"},{id:"battalion",title:"Б"},{id:"company",title:"Р"},{id:"contract",title:"Контрактник",transform:function(t){return"К"==t}},{id:"contractStartDate",title:"Дані про контракт",transform:function(t){return t?g.excel2js(t):null}},{id:"sex",title:"Стать",transform:function(t){return"Ж"==t?"female":"male"}}],progress:function(t){return r.updateProgress("Вичитую дані про штат... (".concat(t,")"))}}),t.next=3,n.getData();case 3:return o=t.sent,a=function(t){return function(e){return e.personId==t}},t.abrupt("return",{getById:function(t){return o.find(a(t))}});case 6:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),j=function(){var t=k(x().mark((function t(e,r,n){var o,a;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=new v(e,{worksheet:"Реєстр видачі",fields:[{id:"documentDate",title:"Дата документа",transform:g.excel2js},{id:"personId",title:"№ фін"},{id:"personName",title:"ПІБ"}].concat((i=r.map((function(t){return{id:t,title:t}})),function(t){if(Array.isArray(t))return b(t)}(i)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(i)||function(t,e){if(t){if("string"==typeof t)return b(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(t,e):void 0}}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),progress:function(t){return n.updateProgress("Вичитую реєстр видачі... (".concat(t,")"))}}),t.next=3,o.getData();case 3:return a=t.sent,t.abrupt("return",a);case 5:case"end":return t.stop()}var i}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),D={getCatalog:S,getStaff:E,getRegistry:j};function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}var L=["props","people"],C=["props","people"],I=["props","people"],_=["props","people"],N=["props","people"];function T(){T=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),c=new I(n||[]);return o(i,"_invoke",{value:j(t,r,c)}),i}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function w(){}var b={};s(b,i,(function(){return this}));var x=Object.getPrototypeOf,O=x&&x(x(_([])));O&&O!==r&&n.call(O,i)&&(b=O);var k=w.prototype=m.prototype=Object.create(b);function S(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,a,i,c){var u=l(t[o],t,a);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==P(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(f).then((function(t){s.value=t,i(s)}),(function(t){return r("throw",t,i,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function j(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=D(c,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=l(e,r,n);if("normal"===s.type){if(o=n.done?y:h,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=l(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(P(e)+" is not iterable")}return g.prototype=w,o(k,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:g,configurable:!0}),g.displayName=s(w,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},S(E.prototype),s(E.prototype,c,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new E(f(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},S(k),s(k,u,"Generator"),s(k,i,(function(){return this})),s(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function A(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function F(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){A(a,n,o,i,c,"next",t)}function c(t){A(a,n,o,i,c,"throw",t)}i(void 0)}))}}function R(t){return function(t){if(Array.isArray(t))return z(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Y(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function B(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?G(Object(r),!0).forEach((function(e){M(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function M(t,e,r){return(e=function(t){var e=function(t){if("object"!=P(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=P(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==P(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function U(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}function H(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=Y(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}function Y(t,e){if(t){if("string"==typeof t)return z(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?z(t,e):void 0}}function z(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var V=["ПІБ","№ фін","K","Б","Р"],K=["Друга категорія","Третя категорія"],W="ВИДАЧА",q=function(t){return!!t.meta.sexFilter[t.sex]},X=function(t,e){return t.meta.isNoReturn&&e<0?0:e},J=function(t){return t.records.reduce((function(e,r){return e+X(t,r.count)}),0)},Q=function(t){if(t.contractStartDate){var e,r=null,n=t.contractStartDate,o=g.inc(t.contractStartDate,{months:t.meta.normPeriod}),a=0,i=H(function(t){var e,r=[],n=0,o=H(t.records);try{for(o.s();!(e=o.n()).done;){var a=e.value;if(X(t,a.count)==a.count&&!(a.count+n<0))if(n+=a.count,a.count>0)r.push(a);else if(a.count<0)for(var i=-a.count;i>0&&r.length;){var c=r[0];c.count>i?(c.count-=i,i=0):(i-=c.count,r.shift())}}}catch(t){o.e(t)}finally{o.f()}return r}(t));try{for(i.s();!(e=i.n()).done;){var c=e.value,u=c.date,s=c.count/t.meta.normCount*t.meta.normPeriod,f=g.inc(u,{months:s});f<n||(!r&&u<n?r=f:(!r&&u<o&&(r=u),a+=c.count))}}catch(t){i.e(t)}finally{i.f()}return{startDate:r||n,totalCount:a}}return{startDate:t.records.length?t.records[0].date:t.admissionDate,totalCount:J(t)}},Z=function(t){for(var e=[],r={months:t.meta.normPeriod},n=g.inc(t.referenceDate,r),o=t.admissionDate;o<n;o=g.inc(o,r))e.push({start:o,end:g.inc(o,r),transferred:0,issued:0,overflow:0,unused:0,max:t.meta.normCount});var a,i=H(t.records);try{var c=function(){var r=a.value,n=e.find((function(t){return r.date>=t.start&&r.date<t.end}));n.issued+=X(t,r.count)};for(i.s();!(a=i.n()).done;)c()}catch(t){i.e(t)}finally{i.f()}for(var u=0,s=0,f=e;s<f.length;s++){var l=f[s];l.transferred=u,l.transferred+l.issued>l.max?l.overflow=l.transferred+l.issued-l.max:l.unused=l.max-(l.transferred+l.issued),u=l.overflow}return e},tt=function(t){var e=t.referenceDate,r=function(r){return t.roundToToday&&r instanceof Date&&r<e&&(r=e),t.onlyActive&&(r=r==e?e:""),t.excelFormat?r instanceof Date?g.js2excel(r):r?"".concat(r," од."):"":r instanceof Date?g.format(r):r?"".concat(r," од."):""},n=t.records[t.records.length-1];if(!q(t))return r("");if(!t.records.length)return r(e);if(t.meta.isInventory){var o=J(t);return r(o<=0?e:o)}if(t.contract){var a=Q(t),i=a.startDate,c=a.totalCount/t.meta.normCount*t.meta.normPeriod;return r(g.inc(i,{months:c}))}if(t.matchMobPeriod){var u=Z(t).find((function(t){return e>=t.start&&e<t.end}));if(u.unused>0)return r(u.start);var s=(u.issued+u.transferred)/t.meta.normCount*t.meta.normPeriod;return r(g.inc(u.start,{months:s}))}if(n.count<0)return r(e);var f=n.date,l=n.count/t.meta.normCount*t.meta.normPeriod;return r(g.inc(f,{months:l}))},et=function(t,e,r){var n=r.props,o=r.people,a=U(r,L),i=n[e],c=o[t],u=c.items[e]||[];c.contract&&(t+=" (КОНТРАКТ)");var s={name:e,meta:i,records:u,admissionDate:c.admissionDate,contract:c.contract,contractStartDate:c.contractStartDate,sex:c.sex,matchMobPeriod:a.matchMobPeriod,referenceDate:a.referenceDate,debug:!0},f=tt(B({},s)),l=tt(B(B({},s),{},{roundToToday:!0}));f!=l&&(f="".concat(f," > ").concat(l));var p=[];if(p.push(t),p.push("Дата прийому: ".concat(g.format(c.admissionDate))),c.contractStartDate&&p.push("Дата контракту: ".concat(g.format(c.contractStartDate))),p.push(""),p.push(e),p.push(""),!q(s))return p.push("Не актуально для цієї статі"),p.join("\n");if(p.push("Історія видачі:"),u.length?(p.push.apply(p,R(u.map((function(t){var e,r=(e=t.count)>=0?"+".concat(e):"".concat(e),n=g.format(t.date),o=X(s,t.count)!=t.count?"(ігнор.)":"";return"".concat(r," од. @ ").concat(n," ").concat(o)})))),p.push("Всього: ".concat(J(s)," од."))):p.push("Відсутня"),!i.isInventory){if(c.contract){p.push(""),p.push("Графік для контрактників:");var h,d=function(t){for(var e=[],r=Q(t).startDate,n={months:t.meta.normPeriod},o=g.inc(new Date,{months:48});r<o;){var a=g.inc(r,n),i=(e.length+1)*t.meta.normCount;e.push({start:r,end:a,count:i}),r=a}return e}(s),y=H(d);try{for(y.s();!(h=y.n()).done;){var v=h.value;p.push("".concat(g.format(v.start)," - ").concat(v.count))}}catch(t){y.e(t)}finally{y.f()}}else{p.push(""),p.push("Графік для мобілізованих:");var m,w=H(Z(s));try{for(w.s();!(m=w.n()).done;){var b=m.value,x="".concat(b.transferred+b.issued,"/").concat(b.max),O=b.overflow?"-> ".concat(b.overflow):"";p.push("".concat(g.format(b.start)," - ").concat(x," ").concat(O))}}catch(t){w.e(t)}finally{w.f()}}p.push(""),p.push("Розрахунок наступної видачі:"),p.push("".concat(f))}return p.push("","---",""),p.push("Норма: ".concat(i.normCount," од. на ").concat(i.normPeriod," міс.")),p.join("\n")},rt=function(t,e,r){var n=Object.keys(e),o=n.length,a=Object.keys(r),i=a.length,c=K.length,u=V.length,s={summaryHeader:{rowOffset:0,colOffset:0,rowCount:c,colCount:1,genData:function(){return K.map((function(t){return[t]}))}},summaryFormulas:{rowOffset:0,colOffset:u,rowCount:c,colCount:o,genData:function(t){return K.map((function(e,r){return n.map((function(e,n){var o=V.length,a=s.tableData,i=l(o+n+1),c=a.rowOffset+1,u=a.rowOffset+a.rowCount;if(t.onlyActive){if(!r){var f=l(a.colOffset+1),p="".concat(f).concat(c,":").concat(f).concat(u),h=s.summaryHeader.rowOffset+1+1;return"=SUBTOTAL(103, ".concat(p,")-").concat(i).concat(h)}var d="".concat(i).concat(c,":").concat(i).concat(u);return"=SUBTOTAL(103, ".concat(d,")")}var y=g.js2excel(g.today()),v="".concat(i).concat(c,":").concat(i).concat(u),m=r?"=":">",w="".concat(v).concat(m).concat(y),b="ROW(".concat(v,")-MIN(ROW(").concat(v,"))"),x="OFFSET(INDEX(".concat(v,", 1), ").concat(b,", 0)"),O="SUBTOTAL(103, ".concat(x,")");return"=SUMPRODUCT((".concat(w,")*").concat(O,")")}))}))}},tableHeader:{rowOffset:c,colOffset:0,rowCount:1,colCount:u+o,genData:function(){return[V.concat(n)]}},tablePropertiesHeader:{rowOffset:c,colOffset:u,rowCount:1,colCount:o},tableData:{rowOffset:c+1,colOffset:0,rowCount:i,colCount:u+o,genData:function(t){return a.map((function(o){var a=r[o],i=a.finId,c=a.contract,u=a.contractStartDate,s=a.battalion,f=a.company,l=a.items,p=a.admissionDate,h=a.sex;return[o,i,c?"К":"",s,f].concat(n.map((function(r){return tt({personName:o,name:r,meta:e[r],records:l[r]||[],admissionDate:p,contract:c,contractStartDate:u,sex:h,roundToToday:!0,onlyActive:t.onlyActive,matchMobPeriod:t.matchMobPeriod,referenceDate:t.referenceDate,excelFormat:!0})})))}))}},tableCalcData:{rowOffset:c+1,colOffset:u,rowCount:i,colCount:o},tableCenterData:{rowOffset:c,colOffset:1,rowCount:1+i,colCount:u+o-1}},f=s[t],p=[f.rowOffset,f.colOffset,f.rowCount,f.colCount];return B(B({},f),{},{range:p})},nt=function(){var t=F(T().mark((function t(e,r){var n,o,a,i,c,u,s,f,l,p,h,d,y,v,m,w,b,x,O,k,S,E,j,P,L,C,I,_;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D.getCatalog(e,r);case 2:return n=t.sent,t.next=5,D.getStaff(e,r);case 5:return o=t.sent,t.next=8,D.getRegistry(e,n.getNames(),r);case 8:a=t.sent,i={},c=H(n.getNames()),t.prev=11,c.s();case 13:if((u=c.n()).done){t.next=21;break}if(s=u.value,(f=n.getByName(s)).normCount&&f.normPeriod){t.next=18;break}return t.abrupt("continue",19);case 18:i[s]=f;case 19:t.next=13;break;case 21:t.next=26;break;case 23:t.prev=23,t.t0=t.catch(11),c.e(t.t0);case 26:return t.prev=26,c.f(),t.finish(26);case 29:l={},p=H(a),t.prev=31,p.s();case 33:if((h=p.n()).done){t.next=65;break}if(d=h.value,y=l[d.personName],N=(v=o.getById(d.personId)).battalion,!(N="".concat(N))||!N.includes("переведено")&&!N.includes("звільнено")){t.next=39;break}return t.abrupt("continue",63);case 39:y?d.documentDate<y.admissionDate&&(y.admissionDate=d.documentDate):y=l[d.personName]={finId:d.personId,admissionDate:d.documentDate,contract:v.contract,contractStartDate:v.contractStartDate,sex:v.sex,battalion:v.battalion,company:v.company,records:0,items:{}},y.records++,m=H(n.getNames()),t.prev=42,m.s();case 44:if((w=m.n()).done){t.next=55;break}if(b=w.value,(x=+"".concat(d[b]).trim())&&!isNaN(x)){t.next=49;break}return t.abrupt("continue",53);case 49:O=y.items[b]=y.items[b]||[],k=O.find((function(t){return t.date==g})),S=O[O.length-1],k&&x*S.count>0?k.count+=x:O.push({date:d.documentDate,count:x});case 53:t.next=44;break;case 55:t.next=60;break;case 57:t.prev=57,t.t1=t.catch(42),m.e(t.t1);case 60:return t.prev=60,m.f(),t.finish(60);case 63:t.next=33;break;case 65:t.next=70;break;case 67:t.prev=67,t.t2=t.catch(31),p.e(t.t2);case 70:return t.prev=70,p.f(),t.finish(70);case 73:for(E=0,j=Object.keys(l);E<j.length;E++)for(P=j[E],L=l[P].items,C=0,I=Object.keys(L);C<I.length;C++)_=I[C],L[_].sort((function(t,e){return t.date-e.date}));return console.log("Каталог: ",i),console.log("Людиська: ",l),t.abrupt("return",{props:i,people:l});case 77:case"end":return t.stop()}var N}),t,null,[[11,23,26,29],[31,67,70,73],[42,57,60,63]])})));return function(e,r){return t.apply(this,arguments)}}(),ot=function(){var t=F(T().mark((function t(e,r){var n,o,a,i,c,u,s,f,l,h;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.props,o=r.people,(a=U(r,C)).updateProgress("Створюю вихідні дані..."),t.next=4,p(e,W,"ЗВЕДЕНА");case 4:return i=t.sent,a.updateProgress("Заповнюю заголовок..."),c=rt("tableHeader",n,o),(u=i.getRangeByIndexes.apply(i,R(c.range))).values=c.genData(),u.format.horizontalAlignment="Center",t.next=12,e.sync();case 12:return a.updateProgress("Заповнюю вихідні дані..."),s=rt("tableData",n,o),f=s.genData(a),i.getRangeByIndexes.apply(i,R(s.range)).values=f,t.next=19,e.sync();case 19:return a.updateProgress("Додаю заголовки для категорій..."),l=rt("summaryHeader",n,o),i.getRangeByIndexes.apply(i,R(l.range)).values=l.genData(),t.next=25,e.sync();case 25:return a.updateProgress("Додаю формули для категорій..."),h=rt("summaryFormulas",n,o),i.getRangeByIndexes.apply(i,R(h.range)).values=h.genData(a),t.next=31,e.sync();case 31:return t.abrupt("return",i);case 32:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),at=function(){var t=F(T().mark((function t(e,r,n){var o,a,i,c,u,s,f,l,p,h,d,y,v,m;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=n.props,a=n.people,(i=U(n,I)).updateProgress("Встановлюю підсвітку для дат..."),c=rt("tableCalcData",o,a),u=r.getRangeByIndexes.apply(r,R(c.range)),s=g.format(i.referenceDate),(f=u.conditionalFormats.add(Excel.ConditionalFormatType.cellValue)).cellValue.format.fill.color="lightgreen",f.cellValue.rule={formula1:'=DATEVALUE("'.concat(s,'")'),operator:"EqualTo"},u.numberFormat="dd.mm.yyyy",t.next=11,e.sync();case 11:return i.updateProgress("Вирівнюю дані по центру..."),l=rt("tableCenterData",o,a),r.getRangeByIndexes.apply(r,R(l.range)).format.horizontalAlignment="Center",t.next=17,e.sync();case 17:return i.updateProgress("Стилізую заголовок таблиці..."),p=rt("tablePropertiesHeader",o,a),(h=r.getRangeByIndexes.apply(r,R(p.range))).format.textOrientation=90,h.format.wrapText=!0,h.format.rowHeight=150,h.load("values"),t.next=26,e.sync();case 26:for(d=h.values[0],y=0;y<d.length;y++)v=d[y],h.getCell(0,y).format.fill.color=(w=o[v]).isInventory?"#FFFF00":w.isNoReturn?"#FFC000":"#FFFFFF";return t.next=30,e.sync();case 30:return i.updateProgress("Встановлюю оптимальний розмір комірок..."),(m=r.getUsedRange()).format.autofitColumns(),m.format.autofitRows(),t.next=36,e.sync();case 36:return t.abrupt("return",r);case 37:case"end":return t.stop()}var w}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),it=function(){var e=F(T().mark((function e(r,n,o){var a,i,c,u,s,f,l,p,h,d,y;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.props,i=o.people,(c=U(o,_)).updateProgress("Конвертую у таблицю..."),u=rt("tableHeader",a,i),s=rt("tableData",a,i),f=n.getRangeByIndexes(u.rowOffset,u.colOffset,u.rowCount+s.rowCount,u.colCount),(l=n.tables.add(f,!0)).showBandedRows=!1,l.style="TableStyleLight21",n.freezePanes.freezeColumns(3),n.freezePanes.freezeRows(3),e.next=12,r.sync();case 12:return c.updateProgress("Приховую зайві колонки..."),(p=n.getRange("D:E")).group(Excel.GroupOption.byColumns),p.columnHidden=!0,e.next=18,r.sync();case 18:return c.updateProgress("Додаю нагадування про оновлення..."),(h=n.getRangeByIndexes(u.rowOffset,u.colOffset,1,1)).load(["width","height","left","top"]),e.next=23,r.sync();case 23:return(d=n.shapes.addTextBox("!!! ОНОВИТИ ПЕРЕД ВИКОРИСТАННЯМ !!!")).name=t+"_refresh_warning",d.width=Math.min(150,h.width),d.height=Math.min(50,h.height),d.left=h.left+h.width/2-d.width/2,d.top=h.top+h.height/2-d.height/2,d.textFrame.horizontalAlignment="Center",d.textFrame.verticalAlignment="Middle",d.fill.setSolidColor("yellow"),e.next=34,r.sync();case 34:return c.updateProgress("Зміщую фокус на першу комірку..."),y=rt("tableCalcData",a,i),n.getRangeByIndexes(y.rowOffset,y.colOffset,1,1).select(),e.next=40,r.sync();case 40:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),ct=function(t,e){var r=e.props,n=e.people,o=U(e,N),a=function(t){return t.worksheetName==W&&1==t.columnCount&&1==t.rowCount&&!!function(t,e){return t.rowIndex>=e.rowOffset&&t.rowIndex<e.rowOffset+e.rowCount&&t.columnIndex>=e.colOffset&&t.columnIndex<e.colOffset+e.colCount}(t,rt("tableCalcData",r,n))},i=function(){var t=F(T().mark((function t(e){var i,c,u,s,f,l;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h(e);case 2:if(i=t.sent,a(i)){t.next=5;break}return t.abrupt("return",o.updateProgress(""));case 5:return c=rt("tableHeader",r,n),u=rt("tableData",r,n),s=function(t,r){return d(e,i.worksheetName,t,r)},t.next=10,s(c.rowOffset,i.columnIndex);case 10:return f=t.sent,t.next=13,s(i.rowIndex,u.colOffset);case 13:l=t.sent,o.updateProgress(et(l,f,B({props:r,people:n},o)));case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();y(t,function(){var t=F(T().mark((function t(e){return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{i(e)}catch(t){o.updateProgress("Помилка: "+t),console.error(t)}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},ut=function(){var t=F(T().mark((function t(e){return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Excel.run(function(){var t=F(T().mark((function t(r){var n,o,a,i;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,nt(r,e);case 2:return n=t.sent,o=n.props,a=n.people,t.next=7,ot(r,B({props:o,people:a},e));case 7:return i=t.sent,t.next=10,at(r,i,B({props:o,people:a},e));case 10:return t.next=12,it(r,i,B({props:o,people:a},e));case 12:ct(r,B({props:o,people:a},e)),e.updateProgress("Готово!");case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),st={run:ut},ft=!1,lt=function(t){ft=t};$("#header").on("dblclick",(function(e){var r;e.ctrlKey&&(lt(!0),r="".concat(t," v").concat("47"," by ").concat("Volodymyr Tytar"),ft&&console.log(r))})),$("#ref-date-control").on("click",(function(t){var e=$(t.target).prop("checked"),r=$("#ref-date").val(),n=g.today().toISOString().split("T")[0];$("#ref-date").css("display",e?"inline":"none"),e&&!r&&$("#ref-date").val(n)})),$("#ref-date").css("display","none"),$("#ref-date").on("change",(function(t){var e=!$(t.target).val();$("#ref-date-control").prop("checked",!e),$("#ref-date").css("display",e?"none":"inline")})),$("#refresh").on("click",(function(){return st.run({onlyActive:$("#only-active").prop("checked"),matchMobPeriod:$("#match-mob-period").prop("checked"),referenceDate:$("#ref-date-control").prop("checked")?g.js2utc($("#ref-date").val()):g.today(),updateProgress:function(t){return $("#update").text(t)}})})),Office.onReady((function(t){if(t.host!==Office.HostType.Excel)$("#ref-date").prop("disabled",!0),$("#ref-date-control").prop("disabled",!0),$("#only-active").prop("disabled",!0),$("#match-mob-period").prop("disabled",!0),$("#refresh").prop("disabled",!0);else{var e=$("#header").text();window.location.href.includes("localhost")?(lt(!0),$("#header").text(e+" (local)")):$("#header").text(e+" (b".concat("47",")"))}}))}(),new URL(r(58394),r.b)}();
//# sourceMappingURL=taskpane.js.map